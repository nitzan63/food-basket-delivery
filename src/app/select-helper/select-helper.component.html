<div mat-dialog-content class="dialog-content" style="min-height: 70vh;">
  <button mat-icon-button class="close-button" (click)="close()" aria-label="Close dialog">
    <mat-icon>close_small</mat-icon>
  </button>

  <div class="button-row" *ngIf="args && args.location">
    <button mat-raised-button color="warning" (click)="clearHelper()">
      {{ settings.lang.clear }}
    </button>
    <button
      mat-raised-button
      color="accent"
      (click)="byLocation()"
    >
      {{ settings.lang.byLocation }}
    </button>

  </div>
  <mat-checkbox
    [(ngModel)]="args.includeFrozen"
    (change)="getHelpers()"
    style="margin-right: 10px"
    *ngIf="isMlt()"
  >
    {{ settings.lang.showFreezed }}</mat-checkbox
  >
  <form (submit)="selectFirst()">
    <mat-form-field style="width: 100%">
      <input
        matInput
        [(ngModel)]="searchString"
        cdk-focus
        (input)="doFilter()"
        placeholder="{{ settings.lang.searchVolunteer }}"
        [ngModelOptions]="{ standalone: true }"
      />
      <mat-icon matSuffix (click)="searchString = ''">backspace</mat-icon>
    </mat-form-field>
    <h4 *ngIf="showingRecentHelpers">{{ settings.lang.recentVolunteers }}</h4>

    <div
      *ngFor="let h of filteredHelpers"
      (click)="select(h)"
      style="display: flex; flex-direction: column"
    >
      <div style="display: flex; justify-content: space-between">
        {{ h.name }}
        <div style="text-align: end" class="secondary-text">
          <div *ngIf="h.assignedDeliveries > 0">
            {{ h.assignedDeliveries }} {{ settings.lang.ActiveDeliveries }}
          </div>
          <div
            *ngIf="h.lastCompletedDeliveryString"
            class="{{ h.isBusyVolunteer }}"
          >
            {{ h.totalRecentDeliveries }}
            {{ settings.lang.deliveriesCompleted }} ({{
              h.lastCompletedDeliveryString
            }})
          </div>
          <div *ngIf="h.fixedFamilies > 0">
            {{ h.fixedFamilies }} {{ settings.lang.families }}
          </div>
          <div *ngIf="h.hadProblem" style="color: red">
            {{ settings.lang.hadProblemBefore }}
          </div>
        </div>
      </div>

      <div class="secondary-text">
        {{ h.phone }}
      </div>
      <div *ngIf="h.location" class="secondary-text">
        {{ h.distance.toFixed(1) }} {{ settings.lang.km }}
        {{ settings.lang.from }} {{ h.distanceFrom }}
      </div>
      <mat-divider></mat-divider>
    </div>
  </form>
  <div class="button-row">
  <button
    mat-raised-button
    color="accent"
    (click)="moreHelpers()"
    *ngIf="showingRecentHelpers || filteredHelpers.length == limit"
    style="margin-left: 10px"
  >
    {{ settings.lang.moreVolunteers }}
  </button>
  <button mat-raised-button color="primary" (click)="addHelper()">
    {{ settings.lang.newVolunteer }}
    </button>
  </div>
</div>
